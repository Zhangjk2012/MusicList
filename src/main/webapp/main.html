<!DOCTYPE html>
<html >
<head>
<title>主页</title>

<meta name="keywords" content="keyword1,keyword2,keyword3">
<meta name="description" content="this is my page">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<link rel="stylesheet" href="styles/style.css">
<link rel="stylesheet" href="styles/divers.css">
<link rel="stylesheet" href="styles/core.css">
<link rel="stylesheet" href="styles/lstyle.css">

</head>
<body>
    <div id="nav" class="m-subnav j-tflag">
        <div class="wrap f-pr">
            <ul class="nav">
                <li><a hidefocus="true" href="main.html" class=""><em>首页</em></a></li>
<!--                 <li><a hidefocus="true" href="/discover/toplist" class="z-slt"><em>联系我们</em></a></li>
 -->            </ul>
        </div>
    </div>
    <!-- 轮播图START -->
	<div id="banner" style="display: none;">
		<div class="bannerCon">
	        <div class="before"><img src="images/left.png" width="32" heigth="63" alt="" /></div>
	        <div class="after"><img src="images/right.png" width="32" height="63" alt="" /></div>
	        <div id="scroll" class="scroll">
	        </div>
	        <div class="bannerBut">
	        	<ul id="bannerButUL" style="display: none">
				</ul>
	        </div>   
	    </div>
	</div>
	<!-- 轮播图END -->
	<div class="g-bd1 f-cb">
		<div class="g-mn1">
			<div class="g-mn1c">
				<div class="g-wrap3">
					<div class="n-rcmd">
						<div class="v-hd2">
							<a href="hotmore" class="tit f-ff2 f-tdn">热门推荐</a>
							<!-- <div class="tab">
								 <a href="/discover/playlist/?cat=%E6%B5%81%E8%A1%8C" class="s-fc3">流行</a>
								<span class="line">|</span> <a
									href="rack.html" class="s-fc3">摇滚</a>
							</div> -->
							
							<span class="more"><a href="hotmore"
								class="s-fc3">更多</a><i class="cor s-bg s-bg-6">&nbsp;</i></span>
						</div>
						
						<!-- --sdfsdfsd -->
						
						<ul id="hotul" class="m-cvrlst f-cb">
						</ul>
					</div>
					<div class="n-rcmd" id="personalRec"></div>
					<div class="n-new">
						<div class="v-hd2">
							<a href="getmorenewdisc" class="tit f-ff2 f-tdn">新碟上架</a> <span
								class="more"><a href="getmorenewdisc" class="s-fc3">更多</a><i
								class="cor s-bg s-bg-6">&nbsp;</i></span>
						</div>
						<div class="n-disk">
							<div class="inner" id="album-roller">
								<a id="roller-right" hidefocus="true" href="javascript:void(0)" class="click-flag pre s-bg s-bg-7 f-tdn">&nbsp;</a>
								<div id="newAlbum" class="roll f-pr">
								</div>
								<a id="roller-left" hidefocus="true" href="javascript:void(0)"
									class="click-flag nxt s-bg s-bg-8 f-tdn">&nbsp;</a>
							</div>
						</div>
					</div>
					<div class="n-bill">
						<div class="v-hd2">
							<a href="toplist" class="tit f-ff2 f-tdn">榜单</a> <span
								class="more"><a href="toplist" class="s-fc3">更多</a><i
								class="cor s-bg s-bg-6">&nbsp;</i></span>
						</div>
						<div class="n-bilst" id="toplist">
							
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/index.js" ></script>
    <script type="text/javascript" src="js/paybutton.js" ></script>
    <script type="text/javascript">
       $(function(){
    	   parent.showPlayBar();
           $.ajax( {  
                url:'titlebars',
                type:'post',  
                cache:false,  
                dataType:'json',  
                success:function(data) {  
                    if(data.msg =="true"){  
                        var d = data.data;
                        var len = d.length;
                        if (d.length == 0) {
                        } else {
                        	for (var i=0;i<(len+2);i++) {
                        		if (i==0) {
	                        		$("#bannerButUL").append('<li style="display: none"></li>');
                        		} else if (i == 1) {
                        			$("#bannerButUL").append('<li class="hover"></li>');
                        		} else if (i == (len+1)) {
                        			$("#bannerButUL").append('<li style="display: none"></li>');
                        		} else {
                        			$("#bannerButUL").append('<li></li>');
                        		}
                        	}
                            var first = d[len-1];
                            var img = "<a href='playmusic?id="+first.song+"'><img src='"+first.picture+"' width='980' height='500' alt='' /></a> ";
                            $("#scroll").append(img);
                            $.each(d,function(n,value) { 
                                img = "<a href='playmusic?id="+value.song+"'><img src='"+value.picture+"' width='980' height='500' alt='' /> </a>";
                                $("#scroll").append(img);
                            });
                            var end = d[0];
                            img = "<a href='playmusic?id="+end.song+"'><img src='"+end.picture+"' width='980' height='500' alt='' /> </a>";
                            $("#scroll").append(img);
                            if (len > 1) {
	                            end = d[1];
	                            img = "<a href='playmusic?id="+end.song+"'><img src='"+end.picture+"' width='980' height='500' alt='' /> </a>";
                            }
                            $("#scroll").append(img);
                            $("#banner").css("display","block");
                            $("#bannerButUL").css("display","block");
                            $('.bannerBut ul li').mouseover(function(){
                                $(this).addClass('hover').siblings('li').removeClass('hover');
                                var _index1=$(this).index();
                                $('.bannerCon .scroll').stop().animate({left:-_index1*750},500);
                            });
                        }
                    }  
                 }
            });
           $.ajax( {  
               url:'hotlist',
               type:'post',  
               cache:false,  
               dataType:'json',  
               success:function(data) {  
                   if(data.msg =="true"){  
                       var d = data.data;
                       var len = d.length;
                       if (d.length == 0) {
                       } else {
                           $.each(d,function(n,value) {
                        	   var html = '<li>';
                        	   html+='<div class="u-cover u-cover-1">';
                        	   html+='<img class="j-flag" width=140 height=140 src="'+value.picture+'">';
                        	   html+='<a title="'+value.name+'" href=\'playmusic?id='+value.id+'\' class="msk"></a>';
                        	   html+='<div class="bottom">';
                        	   html+='<a class="icon-play f-fr" title="播放" href="javascript:play(\''+value.songPath+'\',\''+value.name+'\');"></a>';
                        	   html+='<span class="icon-headset"></span>';
                        	   html+='<span class="icon-headset"></span>';
                        	   html+='</div></div>';
                        	   html+='<p class="dec">';
                        	   html+='<a title="'+value.name+'" href=\'playmusic?id='+value.id+'\' class="tit f-thide s-fc0">'+value.name+'</a>';
                        	   html+='</p>';
                        	   html+='<p>';
                        	   html+='<a title="'+value.singer+'" href="javascript:;" class="nm nm-icn f-thide s-fc3">'+value.singer+'</a>';
                        	   html+='<sup class="u-icn u-icn-1"></sup>';
                        	   html+='<p></li>';
                               $("#hotul").append(html);
                           });
                       }
                   }  
                }
           });
           
           $.ajax( {  
               url:'albumlist',
               type:'post',  
               cache:false,  
               dataType:'json',  
               success:function(data) {  
                   if(data.msg =="true"){ 
                       var d = data.data;
                       var len = d.length;
                       if (len == 0) {
                       } else {
                    	   var i = 1;
                    	   var k = 0;
                    	   var html = '<ul class="f-cb roller-flag" style="left:-0px;">';
                    	   for (i=1;i<=len;i++) {
                    		   var value = d[i-1];
                    		   html+='<li>';
                               html+='<div class="u-cover u-cover-alb1">';
                               html+='<img class="j-img" width=100 height=100 src="'+value.picture+'"/>';
                               html+='<a title="'+value.name+'" href="album?id='+value.id+'" class="msk"></a>';
                               html+='<a class="" title="播放" href="javascript:;"></a>';
                               html+='</div>';
                               html+='<p class="f-thide">';
                               html+='<a title="'+value.name+'" href="album?id='+value.id+'" class="s-fc0 tit">'+value.name+'</a>';
                               html+='</p>';
                               html+='<p class="f-thide">';
                               html+='<a title="'+value.singerName+'" href="javascript:;" class="tit s-fc3">'+value.singerName+'</a>';
                               html+='<p></li>';
                               if (i % 5 == 0) {
                            	   html += "</ul>";
                            	   $("#newAlbum").append(html);
                            	   k+= 645;
                            	   html = "";
                            	   if (i == len) {
                            		   break;
                            	   }
                            	   html = '<ul class="f-cb roller-flag" style="left: '+k+'px;">';;
                            	   
                               }
                    	   }
                    	   if (html != "") {
                    		   html += "</ul>";
                               $("#newAlbum").append(html);
                               html = "";
                    	   }
                    	   initClick();
                       }
                   }  
                }
           });
           
           //榜单
           $.ajax( {  
               url:'songcategory',
               type:'post',  
               cache:false,  
               dataType:'json',  
               success:function(data) {  
                   if(data.msg =="true"){ 
                       var d = data.data;
                       var len = d.length;
                       if (len == 0) {
                       } else {
                           var i = 1;
                           for (i=1;i<=len;i++) {
                               var value = d[i-1];
                               var html = '';
                               if (i == 3) {
                            	   html = '<dl class="blk blk-1">';
                               } else {
                            	   html = '<dl class="blk">';
                               }
	                           html += '<dt class="top"><div class="cver u-cover u-cover-4">';
                               html += '<img class="j-img" alert="picture" src="'+value.picture+'" width="100" height="100">';
                               html += '<a href="toplist?id='+value.id+'" class="msk" title="'+value.name+'"></a>';
                               html += '</div><div class="tit"><a href="toplist?id='+value.id+'" title="'+value.name+'"><h3 class="f-fs1 f-thide">'+value.name+'</h3></a></div></dt><dd><ol>';
                               if (value.songs.length != 0) {
                            	   var songs = value.songs;
                            	   $.each(songs, function(i,val){    
                            		   html += '<li onmouseover="this.className=\'z-hvr\'" onmouseout="this.className=\'\'">';
                            		   html += '<span class="no no-top">'+(i+1)+'</span>';
                            		   html += '<a href="playmusic?id='+val.id+'" class="nm s-fc0 f-thide" title="'+val.songName+'">'+val.songName+'</a>';
                            		   html += '<div class="oper"><a href="javascript:play(\''+val.songPath+'\',\''+val.songName+'\');" class="s-bg s-bg-11" title="播放" hidefocus="true"></a>';
                            		   html += '<a class=" like zan u-icn2 u-icn2-12 " style="margin-top: 3px;margin-right: 0px;"></a> <a href="javascript:;" onclick="songVoteNum(\''+val.id+'\',this)" class="like" style="line-height: 23px;">(<span>'+val.voteNum+'</span>)</a>';
                            		   html += '</div></li>';
                           		   });
                               }
                           	   html += '</ol><div class="more"><a href="toplist?id='+value.id+'" class="s-fc0">查看全部&gt;</a></div></dd></dl>';
                               $("#toplist").append(html);
                           }
                       }
                   }  
                }
           });
            autoTurn();
       });
       
       function initClick() {
    	   var uls = $("#album-roller").find("ul");
           var transflag = false;
           $("#roller-right").click(function() {
               if( transflag ) {
                   return ;
               }
               transflag = true;
               for( var i=0; i<uls.length; i++ ) {
                   var ul = $(uls[i]);
                   var left = parseInt( ul.css("left").replace("px","") );
                   left = left + 645;
                   if( left > 1290 ) {
                       left = -645;
                       ul.css({
                           "left":left + "px",
                           "z-index" : "-1"
                       }); 
                   } else {
                       ul.css({
                           "-webkit-transition": "left 1s ease-out 0s",
                           "transition": "left 1s ease-out 0s",
                           "z-index" : "2",
                       }); 
                       ul.css({
                           "left":left + "px"
                       });
                   }
               }       
               
               setTimeout(function() {
                   $("#roller-right ul").css({
                       "-webkit-transition": "none",
                       "transition": "none",
                       "display" : "block"
                   });  
                   transflag = false;
               }, 1100);
           });
           
           $("#roller-left").click(function() {
               if( transflag ) {
                   return ;
               }
               transflag = true;
               for( var i=0; i<uls.length; i++ ) {
                   var ul = $(uls[i]);
                   var left = parseInt( ul.css("left").replace("px","") );
                   left = left - 645;
                   if( left < -645 ) {
                       left = 1290;
                       ul.css({
                           "left":left + "px",
                           "z-index" : "-1"
                       }); 
                   } else {
                       ul.css({
                           "-webkit-transition": "left 1s ease-out 0s",
                           "transition": "left 1s ease-out 0s",
                           "z-index" : "2",
                       }); 
                       ul.css({
                           "left":left + "px"
                       });
                   }
               }       
               setTimeout(function() {
                   $("#roller-right ul").css({
                       "-webkit-transition": "none",
                       "transition": "none",
                       "display" : "block"
                   });  
                   transflag = false;
               }, 1100);
           });
       }
       
       function play(url,name) {
    	   parent.play(url,name);
       }
       
       function songVoteNum(id,obj) {
           $.ajax( {  
               url:'addSongSupportNum',
               type:'post',  
               cache:false,
               data:{"id":id},
               dataType:'json',  
               success:function(data) {  
                   if(data.success =="true"){
                       var num = parseInt($("> span",obj).html());
                       $("> span",obj).html(num+1);
                   } else {
                       alert("点赞失败。");
                   }  
                }
           });
       }
    </script>
</body>
</html>
